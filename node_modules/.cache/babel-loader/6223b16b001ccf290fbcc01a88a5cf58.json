{"ast":null,"code":"var _jsxFileName = \"/home/meric/elastic/src/App.js\";\nimport React, { Component } from \"react\";\nimport './App.css';\nimport SplitterLayout from 'react-splitter-layout';\nimport 'react-splitter-layout/lib/index.css';\nimport DynamicForm from './components/dynamicForm/dynamicForm';\nimport myJson from './datatypes.json';\nimport txt_input from './datatypes.txt';\nimport txt_output from './datatypes_output.txt';\nimport form from './form_type.txt';\nimport axios from 'axios';\nimport JSONPretty from 'react-json-pretty';\nimport { github } from 'react-json-pretty/themes/monikai.css';\nimport queryBuilder, { filtersAggregation } from 'elastic-builder';\nimport Papa from 'papaparse';\nconst output_query = {\n  \"aggregations\": {\n    \"average_echo_time\": {\n      \"avg\": {\n        \"field\": \"DCMs.Echo_Time.Value\"\n      }\n    },\n    \"minimum_echo_time\": {\n      \"min\": {\n        \"field\": \"DCMs.Echo_Time.Value\"\n      }\n    },\n    \"maximum_echo_time\": {\n      \"max\": {\n        \"field\": \"DCMs.Echo_Time.Value\"\n      }\n    },\n    \"max_repetition_time\": {\n      \"max\": {\n        \"field\": \"DCMs.Repetition_Time.Value\"\n      }\n    },\n    \"min_repetition_time\": {\n      \"min\": {\n        \"field\": \"DCMs.Repetition_Time.Value\"\n      }\n    },\n    \"average_repetition_time\": {\n      \"avg\": {\n        \"field\": \"DCMs.Repetition_Time.Value\"\n      }\n    },\n    \"max_slice_thickness\": {\n      \"max\": {\n        \"field\": \"DCMs.Slice_Thickness.Value\"\n      }\n    },\n    \"min_slice_thickness\": {\n      \"min\": {\n        \"field\": \"DCMs.Slice_Thickness.Value\"\n      }\n    },\n    \"average_slice_thickness\": {\n      \"avg\": {\n        \"field\": \"DCMs.Slice_Thickness.Value\"\n      }\n    },\n    \"average_slab_thickness\": {\n      \"avg\": {\n        \"field\": \"DCMs.MR_Spatial_Saturation_Sequence.Slab_Thickness.Value\"\n      }\n    },\n    \"max_age\": {\n      \"max\": {\n        \"field\": \"DCMs.AGE.Value\"\n      }\n    },\n    \"min_age\": {\n      \"min\": {\n        \"field\": \"DCMs.AGE.Value\"\n      }\n    },\n    \"average_age\": {\n      \"avg\": {\n        \"field\": \"DCMs.AGE.Value\"\n      }\n    },\n    \"max_flip_angle\": {\n      \"max\": {\n        \"field\": \"DCMs.Flip_Angle.Value\"\n      }\n    },\n    \"min_flip_angle\": {\n      \"min\": {\n        \"field\": \"DCMs.Flip_Angle.Value\"\n      }\n    },\n    \"average_flip_angle\": {\n      \"avg\": {\n        \"field\": \"DCMs.Flip_Angle.Value\"\n      }\n    },\n    \"max_SAR\": {\n      \"max\": {\n        \"field\": \"DCMs.SAR.Value\"\n      }\n    },\n    \"min_SAR\": {\n      \"min\": {\n        \"field\": \"DCMs.SAR.Value\"\n      }\n    },\n    \"average_SAR\": {\n      \"avg\": {\n        \"field\": \"DCMs.SAR.Value\"\n      }\n    },\n    \"max_Number_of_Averages\": {\n      \"max\": {\n        \"field\": \"DCMs.Number_of_Averages.Value\"\n      }\n    },\n    \"min_Number_of_Averages\": {\n      \"min\": {\n        \"field\": \"DCMs.Number_of_Averages.Value\"\n      }\n    },\n    \"average_Number_of_Averages\": {\n      \"avg\": {\n        \"field\": \"DCMs.Number_of_Averages.Value\"\n      }\n    }\n  }\n};\nvar dummy = \"\";\n\nvar fileDownload = require('react-file-download');\n\nvar formJson = {\n  \"name\": \"ABCz Form\",\n  \"fields\": []\n};\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.submitHandler = event => {\n      let json = JSON.stringify(event, null, 4);\n      this.generateQuery(json); //console.log(json);\n    };\n\n    this.handleDownload = () => {\n      fileDownload(this.state.response, 'response.json');\n    };\n\n    this.handleCSV = () => {\n      var csv = Papa.unparse(output_query);\n      console.log(csv);\n    };\n\n    this.removeEmptyFields = (requestBody, name, field) => {\n      if (field == \"filter\") {\n        for (var i = 0; i < requestBody._body.query._body.bool.filter.length; i++) {\n          if (requestBody._body.query._body.bool.filter[i]._field.includes(name.replace(/ /g, '_'))) {\n            requestBody._body.query._body.bool.filter.splice(i, 1);\n          }\n        }\n      } else if (field == \"must\") {\n        for (var i = 0; i < requestBody._body.query._body.bool.must.length; i++) {\n          if (requestBody._body.query._body.bool.must[i]._field.includes(name.replace(/ /g, '_'))) {\n            requestBody._body.query._body.bool.must.splice(i, 1);\n          }\n        }\n\n        return requestBody;\n      }\n    };\n\n    this.generateQuery = formResults => {\n      var form = JSON.parse(formResults);\n      let requestBodyUpdated;\n\n      if (this.state.form_type == \"input\") {\n        // Bool query\n        const requestBody = queryBuilder.requestBodySearch().query(queryBuilder.boolQuery().must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[0].name.replace(/ /g, '_') + \".Value\", form.data[0].value)).filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[1].name.replace(/ /g, '_') + \".Value\").gt(form.data[1].value).lte(form.data[2].value)).filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[3].name.replace(/ /g, '_') + \".Value\").gt(form.data[3].value).lte(form.data[4].value)).must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[5].name.replace(/ /g, '_') + \".Value\", form.data[5].value)).must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[6].name.replace(/ /g, '_') + \".Value\", form.data[6].value)).filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[7].name.replace(/ /g, '_') + \".Value\").gt(form.data[7].value).lte(form.data[8].value)).filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[9].name.replace(/ /g, '_') + \".Value\").gt(form.data[9].value).lte(form.data[10].value)).filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[11].name.replace(/ /g, '_') + \".Value\").gt(form.data[11].value).lte(form.data[12].value)).filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[13].name.replace(/ /g, '_') + \".Value\").gt(form.data[13].value).lte(form.data[14].value)).must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[15].name.replace(/ /g, '_') + \".Value\", form.data[15].value)));\n\n        for (var i = 0; i <= form.data.length - 1; i++) {\n          console.log(\"girdi\");\n\n          if (i != form.data.length - 1 && form.data[i].name == form.data[i + 1].name) {\n            if (form.data[i].value == \"\") {\n              requestBodyUpdated = this.removeEmptyFields(requestBody, form.data[i].name, \"filter\");\n            }\n\n            i++;\n          } else if (i == form.data.length) {\n            if (form.data[i].value == \"\") {\n              requestBodyUpdated = this.removeEmptyFields(requestBody, form.data[i].name, \"must\");\n            }\n          } else {\n            if (form.data[i].value == \"\") {\n              requestBodyUpdated = this.removeEmptyFields(requestBody, form.data[i].name, \"must\");\n            }\n          }\n        }\n\n        if (requestBody._body.query._body.bool.must.length > 0) {\n          for (var i = 0; i < requestBody._body.query._body.bool.must.length; i++) {\n            if (requestBody._body.query._body.bool.must[i]._field.includes(\"Image_Type\")) {\n              requestBody._body.query._body.bool.must.splice(i, 1);\n            }\n          }\n        }\n\n        if (requestBody._body.query._body.bool.filter.length == 0) {\n          delete requestBody._body.query._body.bool.filter;\n        }\n\n        if (requestBody._body.query._body.bool.must.length == 0) {\n          delete requestBody._body.query._body.bool.must;\n        }\n\n        if (requestBody._body.query._body.bool.filter.length != 0) {\n          for (var i = 0; i < requestBody._body.query._body.bool.filter.length; i++) {\n            if (requestBody._body.query._body.bool.filter[i]._field.includes(\"Instance_Creation_Time\")) {\n              let time_gt = requestBody._body.query._body.bool.filter[i]._queryOpts.gt;\n              let time_lte = requestBody._body.query._body.bool.filter[i]._queryOpts.lte;\n              time_gt = time_gt.replace(\":\", \"\");\n              time_lte = time_lte.replace(\":\", \"\");\n              time_gt = time_gt + \"00.000\";\n              time_lte = time_lte + \"00.000\";\n              requestBody._body.query._body.bool.filter[i]._queryOpts.gt = time_gt;\n              requestBody._body.query._body.bool.filter[i]._queryOpts.lte = time_lte;\n            }\n\n            if (requestBody._body.query._body.bool.filter[i]._field.includes(\"Study_Time\")) {\n              let time_gt = requestBody._body.query._body.bool.filter[i]._queryOpts.gt;\n              let time_lte = requestBody._body.query._body.bool.filter[i]._queryOpts.lte;\n              time_gt = time_gt.replace(\":\", \"\");\n              time_lte = time_lte.replace(\":\", \"\");\n              time_gt = time_gt + \"00.000\";\n              time_lte = time_lte + \"00.000\";\n              requestBody._body.query._body.bool.filter[i]._queryOpts.gt = time_gt;\n              requestBody._body.query._body.bool.filter[i]._queryOpts.lte = time_lte;\n            }\n          }\n        }\n\n        requestBodyUpdated = requestBody;\n        console.log(requestBody); //this.sendRequest(JSON.stringify(requestBodyUpdated));\n      } else if (this.state.form_type == \"output\") {\n        // Bool query\n        const requestBody = queryBuilder.requestBodySearch().query(queryBuilder.boolQuery().must(queryBuilder.matchQuery(\"DCMs.\" + form.data[0].name.replace(/ /g, '_') + \".Value\", form.data[0].value)).must(queryBuilder.matchQuery(\"DCMs.\" + form.data[1].name.replace(/ /g, '_') + \".Value\", form.data[1].value)).must(queryBuilder.matchQuery(\"DCMs.\" + form.data[2].name.replace(/ /g, '_') + \".Value\", form.data[2].value)).must(queryBuilder.matchQuery(\"DCMs.\" + form.data[3].name.replace(/ /g, '_') + \".Value\", form.data[3].value)).must(queryBuilder.matchQuery(\"DCMs.\" + form.data[4].name.replace(/ /g, '_') + \".Value\", form.data[4].value)));\n        console.log(requestBody.toJSON());\n\n        for (var i = form.data.length - 1; i >= 0; i--) {\n          if (form.data[i].value == \"\") {\n            requestBody._body.query._body.bool.must.splice(i, 1);\n          }\n        }\n\n        let str_requestBody = JSON.stringify(requestBody);\n        str_requestBody = str_requestBody.substring(0, str_requestBody.length - 1);\n        let str_output_query = JSON.stringify(output_query);\n        str_output_query = str_output_query.substring(1, str_output_query.length);\n        str_requestBody = str_requestBody + \",\" + str_output_query;\n        this.sendRequest(str_requestBody);\n      }\n    };\n\n    this.state = {\n      form: formJson,\n      response: 'response',\n      form_type: dummy\n    };\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick() {\n    axios.get().then(res => {\n      this.setState({\n        todo: res.data\n      });\n    });\n  }\n\n  sendRequest(requestBody) {\n    var panel = document.getElementById(\"resultPanel\");\n    console.log(\"requestBody: \" + requestBody);\n    fetch('http://127.0.0.1:5000/query', {\n      method: \"POST\",\n      //Request Type \n      body: requestBody,\n      //post body \n      headers: {\n        //Header Defination \n        'Content-Type': 'application/json'\n      }\n    }).then(response => response.json()) //If response is in json then in success\n    .then(responseJson => {\n      //alert(JSON.stringify(responseJson));\n      console.log(responseJson);\n      const json = JSON.stringify(responseJson, null, 4);\n      this.setState({\n        response: json\n      });\n    }) //If response is not in json then in error \n    .catch(error => {\n      alert(JSON.stringify(error)); //console.error(error);\n    });\n  }\n\n  componentWillMount() {\n    fetch(form).then(r => r.text()).then(text => {\n      //this.setState({\n      //    form_type: text\n      //  \n      //});\n      dummy = text;\n      console.log(dummy);\n    });\n    this.setState({\n      form_type: dummy\n    });\n    console.log(this.state.form_type);\n\n    if (this.state.form_type == \"input\") {\n      fetch(txt_input).then(r => r.text()).then(text => {\n        let myarray = text.split('\\n');\n        let dataArray = myarray.map((element, i) => {\n          var array = element.split(' ');\n\n          if (array.length === 4) {\n            let name = array[0];\n            name = name.replace(/_/g, ' ');\n            let type = array[1];\n            let options = array[2];\n            options = options.replace(/\\)/g, '');\n            options = options.replace(/\\(/g, '');\n            let optionsArray = options.split(',');\n            var optionData = {\n              \"options\": []\n            };\n            var data = {};\n            optionsArray.map((option, i) => {\n              optionData.options.push({\n                \"display\": option\n              });\n            });\n            return {\n              \"id\": name,\n              \"label\": name,\n              \"description\": \"\",\n              \"type\": type,\n              \"value\": \"\",\n              \"required\": \"false\",\n              \"placeholder\": \"\",\n              \"definition\": optionData\n            };\n          } else if (array.length === 3) {\n            let name = array[0];\n            name = name.replace(/_/g, ' ');\n            let type = array[1];\n            return {\n              \"id\": name,\n              \"label\": name,\n              \"description\": \"\",\n              \"type\": type,\n              \"value\": \"\",\n              \"required\": \"false\",\n              \"placeholder\": \"\"\n            };\n          }\n        });\n        this.setState({\n          form: {\n            fields: dataArray\n          }\n        });\n        console.log(dataArray);\n      });\n    } else if (this.state.form_type == \"output\") {\n      fetch(txt_output).then(r => r.text()).then(text => {\n        let myarray = text.split('\\n');\n        let dataArray = myarray.map((element, i) => {\n          var array = element.split(' ');\n\n          if (array.length === 4) {\n            let name = array[0];\n            name = name.replace(/_/g, ' ');\n            let type = array[1];\n            let options = array[2];\n            options = options.replace(/\\)/g, '');\n            options = options.replace(/\\(/g, '');\n            let optionsArray = options.split(',');\n            var optionData = {\n              \"options\": []\n            };\n            var data = {};\n            optionsArray.map((option, i) => {\n              optionData.options.push({\n                \"display\": option\n              });\n            });\n            return {\n              \"id\": name,\n              \"label\": name,\n              \"description\": \"\",\n              \"type\": type,\n              \"value\": \"\",\n              \"required\": \"false\",\n              \"placeholder\": \"\",\n              \"definition\": optionData\n            };\n          } else if (array.length === 3) {\n            let name = array[0];\n            name = name.replace(/_/g, ' ');\n            let type = array[1];\n            return {\n              \"id\": name,\n              \"label\": name,\n              \"description\": \"\",\n              \"type\": type,\n              \"value\": \"\",\n              \"required\": \"false\",\n              \"placeholder\": \"\"\n            };\n          }\n        });\n        this.setState({\n          form: {\n            fields: dataArray\n          }\n        });\n        console.log(dataArray);\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 526\n      },\n      __self: this\n    }, React.createElement(SplitterLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 528\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 529\n      },\n      __self: this\n    }, React.createElement(DynamicForm, {\n      id: \"form\",\n      config: this.state.form,\n      onSubmit: event => this.submitHandler(event),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 531\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"PanelRight\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 536\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      id: \"download\",\n      onClick: () => this.handleDownload(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 537\n      },\n      __self: this\n    }, \"Download\"), React.createElement(\"button\", {\n      id: \"download\",\n      onClick: () => this.handleCSV(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 538\n      },\n      __self: this\n    }, \"Download CSV\"), React.createElement(JSONPretty, {\n      id: \"resultPanel\",\n      json: this.state.response,\n      theme: github,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 540\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/meric/elastic/src/App.js"],"names":["React","Component","SplitterLayout","DynamicForm","myJson","txt_input","txt_output","form","axios","JSONPretty","github","queryBuilder","filtersAggregation","Papa","output_query","dummy","fileDownload","require","formJson","App","constructor","props","submitHandler","event","json","JSON","stringify","generateQuery","handleDownload","state","response","handleCSV","csv","unparse","console","log","removeEmptyFields","requestBody","name","field","i","_body","query","bool","filter","length","_field","includes","replace","splice","must","formResults","parse","requestBodyUpdated","form_type","requestBodySearch","boolQuery","matchQuery","data","value","rangeQuery","gt","lte","time_gt","_queryOpts","time_lte","toJSON","str_requestBody","substring","str_output_query","sendRequest","handleClick","bind","get","then","res","setState","todo","panel","document","getElementById","fetch","method","body","headers","responseJson","catch","error","alert","componentWillMount","r","text","myarray","split","dataArray","map","element","array","type","options","optionsArray","optionData","option","push","fields","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport './App.css';\nimport SplitterLayout from 'react-splitter-layout';\nimport 'react-splitter-layout/lib/index.css';\nimport DynamicForm from './components/dynamicForm/dynamicForm';\nimport myJson from './datatypes.json';\nimport txt_input from './datatypes.txt';\nimport txt_output from './datatypes_output.txt';\nimport form from './form_type.txt';\nimport axios from 'axios';\nimport JSONPretty from 'react-json-pretty';\nimport { github } from 'react-json-pretty/themes/monikai.css';\nimport queryBuilder, { filtersAggregation } from 'elastic-builder';\nimport Papa from 'papaparse';\n\n\nconst output_query =\n{\n  \"aggregations\": {\n    \"average_echo_time\": {\n      \"avg\": {\n        \"field\": \"DCMs.Echo_Time.Value\"\n      }\n    },\n    \"minimum_echo_time\": {\n      \"min\": {\n        \"field\": \"DCMs.Echo_Time.Value\"\n      }\n    },\n    \"maximum_echo_time\": {\n      \"max\": {\n        \"field\": \"DCMs.Echo_Time.Value\"\n      }\n    },\n    \"max_repetition_time\": {\n      \"max\": {\n        \"field\": \"DCMs.Repetition_Time.Value\"\n      }\n    },\n    \"min_repetition_time\": {\n      \"min\": {\n        \"field\": \"DCMs.Repetition_Time.Value\"\n      }\n    },\n    \"average_repetition_time\": {\n      \"avg\": {\n        \"field\": \"DCMs.Repetition_Time.Value\"\n      }\n    },\n    \"max_slice_thickness\": {\n      \"max\": {\n        \"field\": \"DCMs.Slice_Thickness.Value\"\n      }\n    },\n    \"min_slice_thickness\": {\n      \"min\": {\n        \"field\": \"DCMs.Slice_Thickness.Value\"\n      }\n    },\n    \"average_slice_thickness\": {\n      \"avg\": {\n        \"field\": \"DCMs.Slice_Thickness.Value\"\n      }\n    },\n    \"average_slab_thickness\": {\n      \"avg\": {\n        \"field\": \"DCMs.MR_Spatial_Saturation_Sequence.Slab_Thickness.Value\"\n      }\n    },\n    \"max_age\": {\n      \"max\": {\n        \"field\": \"DCMs.AGE.Value\"\n      }\n    },\n    \"min_age\": {\n      \"min\": {\n        \"field\": \"DCMs.AGE.Value\"\n      }\n    },\n    \"average_age\": {\n      \"avg\": {\n        \"field\": \"DCMs.AGE.Value\"\n      }\n    },\n    \"max_flip_angle\": {\n      \"max\": {\n        \"field\": \"DCMs.Flip_Angle.Value\"\n      }\n    },\n    \"min_flip_angle\": {\n      \"min\": {\n        \"field\": \"DCMs.Flip_Angle.Value\"\n      }\n    },\n    \"average_flip_angle\": {\n      \"avg\": {\n        \"field\": \"DCMs.Flip_Angle.Value\"\n      }\n    },\n    \"max_SAR\": {\n      \"max\": {\n        \"field\": \"DCMs.SAR.Value\"\n      }\n    },\n    \"min_SAR\": {\n      \"min\": {\n        \"field\": \"DCMs.SAR.Value\"\n      }\n    },\n    \"average_SAR\": {\n      \"avg\": {\n        \"field\": \"DCMs.SAR.Value\"\n      }\n    },\n    \"max_Number_of_Averages\": {\n      \"max\": {\n        \"field\": \"DCMs.Number_of_Averages.Value\"\n      }\n    },\n    \"min_Number_of_Averages\": {\n      \"min\": {\n        \"field\": \"DCMs.Number_of_Averages.Value\"\n      }\n    },\n    \"average_Number_of_Averages\": {\n      \"avg\": {\n        \"field\": \"DCMs.Number_of_Averages.Value\"\n      }\n    }\n  }\n};\n\nvar dummy = \"\"\nvar fileDownload = require('react-file-download');\nvar formJson = {\n  \"name\": \"ABCz Form\",\n  \"fields\": []\n};\n\nclass App extends Component {\n\n  constructor(props) {\n\n    super(props);\n    this.state = {\n\n      form: formJson,\n      response: 'response',\n      form_type: dummy\n    }\n    this.handleClick = this.handleClick.bind(this)\n  }\n\n  handleClick() {\n    axios.get()\n      .then(res => {\n        this.setState({\n          todo: res.data\n        })\n      })\n  }\n\n  sendRequest(requestBody) {\n    var panel = document.getElementById(\"resultPanel\");\n    console.log(\"requestBody: \" + requestBody)\n    fetch('http://127.0.0.1:5000/query', {\n      method: \"POST\",//Request Type \n      body: requestBody,//post body \n      headers: {//Header Defination \n        'Content-Type': 'application/json',\n      },\n    })\n      .then((response) => response.json())\n      //If response is in json then in success\n      .then((responseJson) => {\n        //alert(JSON.stringify(responseJson));\n        console.log(responseJson);\n        const json = JSON.stringify(responseJson, null, 4)\n\n\n        this.setState({\n\n          response: json\n\n        });\n      })\n      //If response is not in json then in error \n      .catch((error) => {\n        alert(JSON.stringify(error));\n        //console.error(error);\n      });\n\n\n  }\n\n  submitHandler = (event) => {\n    let json = JSON.stringify(event, null, 4);\n    this.generateQuery(json);\n    //console.log(json);\n  }\n\n\n  handleDownload = () => {\n    fileDownload(this.state.response, 'response.json');\n  }\n\n  handleCSV = () => {\n    var csv = Papa.unparse(output_query);\n    console.log(csv)\n  }\n\n  removeEmptyFields = (requestBody, name, field) => {\n    if (field == \"filter\") {\n      for (var i = 0; i < requestBody._body.query._body.bool.filter.length; i++) {\n\n        if (requestBody._body.query._body.bool.filter[i]._field.includes(name.replace(/ /g, '_'))) {\n          requestBody._body.query._body.bool.filter.splice(i, 1)\n\n        }\n      }\n\n\n    }\n    else if (field == \"must\") {\n      for (var i = 0; i < requestBody._body.query._body.bool.must.length; i++) {\n        if (requestBody._body.query._body.bool.must[i]._field.includes(name.replace(/ /g, '_'))) {\n          requestBody._body.query._body.bool.must.splice(i, 1)\n\n        }\n      }\n      return requestBody;\n\n    }\n\n  }\n\n  generateQuery = (formResults) => {\n\n    var form = JSON.parse(formResults);\n    let requestBodyUpdated;\n\n    if (this.state.form_type == \"input\") {\n\n      // Bool query\n      const requestBody = queryBuilder.requestBodySearch().query(\n        queryBuilder.boolQuery()\n          .must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[0].name.replace(/ /g, '_') + \".Value\", form.data[0].value))\n          .filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[1].name.replace(/ /g, '_') + \".Value\").gt(form.data[1].value).lte(form.data[2].value))\n          .filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[3].name.replace(/ /g, '_') + \".Value\").gt(form.data[3].value).lte(form.data[4].value))\n          .must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[5].name.replace(/ /g, '_') + \".Value\", form.data[5].value))\n          .must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[6].name.replace(/ /g, '_') + \".Value\", form.data[6].value))\n          .filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[7].name.replace(/ /g, '_') + \".Value\").gt(form.data[7].value).lte(form.data[8].value))\n          .filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[9].name.replace(/ /g, '_') + \".Value\").gt(form.data[9].value).lte(form.data[10].value))\n          .filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[11].name.replace(/ /g, '_') + \".Value\").gt(form.data[11].value).lte(form.data[12].value))\n          .filter(queryBuilder.rangeQuery(\"studies.DCMs.\" + form.data[13].name.replace(/ /g, '_') + \".Value\").gt(form.data[13].value).lte(form.data[14].value))\n          .must(queryBuilder.matchQuery(\"studies.DCMs.\" + form.data[15].name.replace(/ /g, '_') + \".Value\", form.data[15].value))\n      );\n\n      for (var i = 0; i <= form.data.length - 1; i++) {\n        console.log(\"girdi\")\n        if (i != form.data.length - 1 && form.data[i].name == form.data[i + 1].name) {\n          if (form.data[i].value == \"\") {\n            requestBodyUpdated = this.removeEmptyFields(requestBody, form.data[i].name, \"filter\")\n          }\n          i++;\n        }\n        else if (i == form.data.length) {\n          if (form.data[i].value == \"\") {\n            requestBodyUpdated = this.removeEmptyFields(requestBody, form.data[i].name, \"must\")\n          }\n        }\n        else {\n          if (form.data[i].value == \"\") {\n            requestBodyUpdated = this.removeEmptyFields(requestBody, form.data[i].name, \"must\")\n\n          }\n        }\n      }\n\n      if (requestBody._body.query._body.bool.must.length > 0) {\n        for (var i = 0; i < requestBody._body.query._body.bool.must.length; i++) {\n\n          if (requestBody._body.query._body.bool.must[i]._field.includes(\"Image_Type\")) {\n            requestBody._body.query._body.bool.must.splice(i, 1)\n\n          }\n        }\n      }\n\n      if (requestBody._body.query._body.bool.filter.length == 0) {\n        delete requestBody._body.query._body.bool.filter;\n      }\n\n      if (requestBody._body.query._body.bool.must.length == 0) {\n        delete requestBody._body.query._body.bool.must;\n      }\n\n      if (requestBody._body.query._body.bool.filter.length != 0) {\n\n        for (var i = 0; i < requestBody._body.query._body.bool.filter.length; i++) {\n\n          if (requestBody._body.query._body.bool.filter[i]._field.includes(\"Instance_Creation_Time\")) {\n            let time_gt = requestBody._body.query._body.bool.filter[i]._queryOpts.gt;\n            let time_lte = requestBody._body.query._body.bool.filter[i]._queryOpts.lte;\n\n            time_gt = time_gt.replace(\":\", \"\");\n            time_lte = time_lte.replace(\":\", \"\");\n\n            time_gt = time_gt + \"00.000\";\n            time_lte = time_lte + \"00.000\";\n\n            requestBody._body.query._body.bool.filter[i]._queryOpts.gt = time_gt;\n            requestBody._body.query._body.bool.filter[i]._queryOpts.lte = time_lte;\n\n          }\n\n          if (requestBody._body.query._body.bool.filter[i]._field.includes(\"Study_Time\")) {\n            let time_gt = requestBody._body.query._body.bool.filter[i]._queryOpts.gt;\n            let time_lte = requestBody._body.query._body.bool.filter[i]._queryOpts.lte;\n\n            time_gt = time_gt.replace(\":\", \"\");\n            time_lte = time_lte.replace(\":\", \"\");\n\n            time_gt = time_gt + \"00.000\";\n            time_lte = time_lte + \"00.000\";\n\n            requestBody._body.query._body.bool.filter[i]._queryOpts.gt = time_gt;\n            requestBody._body.query._body.bool.filter[i]._queryOpts.lte = time_lte;\n\n\n          }\n        }\n      }\n\n      requestBodyUpdated = requestBody;\n      console.log(requestBody)\n      //this.sendRequest(JSON.stringify(requestBodyUpdated));\n    }\n    else if (this.state.form_type == \"output\") {\n\n      // Bool query\n      const requestBody = queryBuilder.requestBodySearch().query(\n        queryBuilder.boolQuery()\n          .must(queryBuilder.matchQuery(\"DCMs.\" + form.data[0].name.replace(/ /g, '_') + \".Value\", form.data[0].value))\n          .must(queryBuilder.matchQuery(\"DCMs.\" + form.data[1].name.replace(/ /g, '_') + \".Value\", form.data[1].value))\n          .must(queryBuilder.matchQuery(\"DCMs.\" + form.data[2].name.replace(/ /g, '_') + \".Value\", form.data[2].value))\n          .must(queryBuilder.matchQuery(\"DCMs.\" + form.data[3].name.replace(/ /g, '_') + \".Value\", form.data[3].value))\n          .must(queryBuilder.matchQuery(\"DCMs.\" + form.data[4].name.replace(/ /g, '_') + \".Value\", form.data[4].value))\n      );\n\n      console.log(requestBody.toJSON())\n      for (var i = form.data.length - 1; i >= 0; i--) {\n        if (form.data[i].value == \"\") {\n          requestBody._body.query._body.bool.must.splice(i, 1);\n        }\n      }\n\n      let str_requestBody = (JSON.stringify(requestBody));\n      str_requestBody = str_requestBody.substring(0, str_requestBody.length - 1);\n      let str_output_query = JSON.stringify(output_query);\n      str_output_query = str_output_query.substring(1, str_output_query.length);\n      str_requestBody = str_requestBody + \",\" + str_output_query;\n\n      this.sendRequest(str_requestBody);\n    }\n\n  }\n\n  componentWillMount() {\n    fetch(form)\n      .then((r) => r.text())\n      .then(text => {\n        //this.setState({\n        //    form_type: text\n        //  \n        //});\n        dummy = text;\n        console.log(dummy)\n      })\n        this.setState({\n            form_type: dummy\n          \n        });\n      console.log(this.state.form_type)\n\n    if (this.state.form_type == \"input\") {\n\n      fetch(txt_input)\n        .then((r) => r.text())\n        .then(text => {\n          let myarray = text.split('\\n');\n          let dataArray = myarray.map((element, i) => {\n\n\n            var array = element.split(' ');\n\n            if (array.length === 4) {\n\n              let name = array[0];\n              name = name.replace(/_/g, ' ');\n              let type = array[1];\n              let options = array[2];\n              options = options.replace(/\\)/g, '');\n              options = options.replace(/\\(/g, '');\n              let optionsArray = options.split(',');\n\n              var optionData = { \"options\": [] };\n              var data = {};\n              optionsArray.map((option, i) => {\n                optionData.options.push({ \"display\": option });\n              })\n\n              return {\n                \"id\": name,\n                \"label\": name,\n                \"description\": \"\",\n                \"type\": type,\n                \"value\": \"\",\n                \"required\": \"false\",\n                \"placeholder\": \"\",\n                \"definition\": optionData\n              };\n\n            }\n\n            else if (array.length === 3) {\n              let name = array[0];\n              name = name.replace(/_/g, ' ');\n              let type = array[1];\n\n              return {\n                \"id\": name,\n                \"label\": name,\n                \"description\": \"\",\n                \"type\": type,\n                \"value\": \"\",\n                \"required\": \"false\",\n                \"placeholder\": \"\"\n              };\n            }\n\n          })\n\n          this.setState({\n            form: {\n              fields: dataArray\n            }\n          });\n          console.log(dataArray);\n\n        })\n    }\n    else if (this.state.form_type == \"output\") {\n\n\n      fetch(txt_output)\n        .then((r) => r.text())\n        .then(text => {\n          let myarray = text.split('\\n');\n          let dataArray = myarray.map((element, i) => {\n\n\n            var array = element.split(' ');\n\n            if (array.length === 4) {\n\n              let name = array[0];\n              name = name.replace(/_/g, ' ');\n              let type = array[1];\n              let options = array[2];\n              options = options.replace(/\\)/g, '');\n              options = options.replace(/\\(/g, '');\n              let optionsArray = options.split(',');\n\n              var optionData = { \"options\": [] };\n              var data = {};\n              optionsArray.map((option, i) => {\n                optionData.options.push({ \"display\": option });\n              })\n\n              return {\n                \"id\": name,\n                \"label\": name,\n                \"description\": \"\",\n                \"type\": type,\n                \"value\": \"\",\n                \"required\": \"false\",\n                \"placeholder\": \"\",\n                \"definition\": optionData\n              };\n\n            }\n\n            else if (array.length === 3) {\n              let name = array[0];\n              name = name.replace(/_/g, ' ');\n              let type = array[1];\n\n              return {\n                \"id\": name,\n                \"label\": name,\n                \"description\": \"\",\n                \"type\": type,\n                \"value\": \"\",\n                \"required\": \"false\",\n                \"placeholder\": \"\"\n              };\n            }\n\n          })\n\n          this.setState({\n            form: {\n              fields: dataArray\n            }\n          });\n          console.log(dataArray);\n\n        })\n\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n\n        <SplitterLayout>\n          <div className=\"Form\">\n\n            <DynamicForm id=\"form\" config={this.state.form} onSubmit={(event) => this.submitHandler(event)}></DynamicForm>\n\n          </div>\n\n\n          <div className=\"PanelRight\">\n            <button id=\"download\" onClick={() => this.handleDownload()}>Download</button>\n            <button id=\"download\" onClick={() => this.handleCSV()}>Download CSV</button>\n\n            <JSONPretty id=\"resultPanel\" json={this.state.response} theme={github} />\n          </div>\n        </SplitterLayout>\n\n      </div>\n    );\n  }\n}\n\nexport default App;\n\n"]},"metadata":{},"sourceType":"module"}